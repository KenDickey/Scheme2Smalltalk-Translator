'# This file is encoded in ASCII# line delimitor is CR.SmallSchemeSmallScheme code for Squeak 3.4Translated from file /usr/local/src/Squeak/ProtoScheme/scm/format.scm'!!SmallScheme class methodsFor: 'initialization'!initFormat SmallScheme define:  #'format'  as: (  [ :lastX2DwasX2Dnewline :asciiX2Dtab :asciiX2Dff :dontX2Dprint |                       [ :X3CoutputX2DportX3E :X3CformatX2DstringX3E :X3CargsX3E |                X3CargsX3E := X3CargsX3E asRest.                               [ | port returnX2Dvalue |                                 port := ( (((((SmallScheme globalRef:  #'outputX2DportX3F')                          value: ( X3CoutputX2DportX3E))) == false) not)                     	ifTrue: [ X3CoutputX2DportX3E]                     	ifFalse: [ (((((SmallScheme globalRef:  #'eqX3F')                              value: ( X3CoutputX2DportX3E) value: ( true))) == false) not)                         	ifTrue: [((SmallScheme globalRef:  #'currentX2DoutputX2Dport')                              value)]                         	ifFalse: [ (((((SmallScheme globalRef:  #'eqX3F')                                  value: ( X3CoutputX2DportX3E) value: ( false))) == false) not)                             	ifTrue: [((SmallScheme globalRef:  #'openX2DoutputX2Dstring')                                  value)]                             	ifFalse: [((SmallScheme globalRef:  #'error')                                  value: ( 'format: bad port -> ') value: ( X3CoutputX2DportX3E))]]]).                  returnX2Dvalue := ( (((((SmallScheme globalRef:  #'eqX3F')                          value: ( X3CoutputX2DportX3E) value: ( false))) == false) not)                     	ifTrue: [                     [((SmallScheme globalRef:  #'getX2DoutputX2Dstring')                              value: ( port))]]                     	ifFalse: [                     [ dontX2Dprint]]).                                       [ | formatX2Dhelp |                                         formatX2Dhelp := (                     [ :formatX2Dstrg :arglyst |                           [ | lengthX2DofX2DformatX2Dstring anycharX2Ddispatch tildeX2Ddispatch |                                                     lengthX2DofX2DformatX2Dstring := (((SmallScheme globalRef:  #'stringX2Dlength')                                value: ( formatX2Dstrg))).                            anycharX2Ddispatch := (                           [ :pos :arglist :lastX2DcharX2DwasX2Dnl |  (((((SmallScheme globalRef:  #'X3EX3D')                                        value: ( pos) value: ( lengthX2DofX2DformatX2Dstring))) == false) not)                                   	ifTrue: [ [                                     (lastX2DwasX2Dnewline :=  lastX2DcharX2DwasX2Dnl).                                      arglist.                                    ] value]                                   	ifFalse: [ [ :char |                                         (((((SmallScheme globalRef:  #'eqX3F')                                                value: ( char) value: ( $~))) == false) not)                                           	ifTrue: [(tildeX2Ddispatch value: (((SmallScheme globalRef:  #'X2B')                                                value: ( pos) value: ( 1))) value: ( arglist) value: ( lastX2DcharX2DwasX2Dnl))]                                           	ifFalse: [ [                                             ((SmallScheme globalRef:  #'writeX2Dchar')                                                  value: ( char) value: ( port)).                                             (anycharX2Ddispatch value: (((SmallScheme globalRef:  #'X2B')                                                  value: ( pos) value: ( 1))) value: ( arglist) value: ( false)).                                            ] value].                                   ] valueWithArguments: {(((SmallScheme globalRef:  #'stringX2Dref')                                            value: ( formatX2Dstrg) value: ( pos))). }]]).                            tildeX2Ddispatch := (                           [ :pos :arglist :lastX2DcharX2DwasX2Dnl |  (((((SmallScheme globalRef:  #'X3EX3D')                                        value: ( pos) value: ( lengthX2DofX2DformatX2Dstring))) == false) not)                                   	ifTrue: [ [                                     ((SmallScheme globalRef:  #'writeX2Dchar')                                          value: ( $~) value: ( port)).                                     (lastX2DwasX2Dnewline :=  lastX2DcharX2DwasX2Dnl).                                      arglist.                                    ] value]                                   	ifFalse: [ [ :key57 |                                         (((((SmallScheme globalRef:  #'memv')                                                value: ( key57) value: ( ({ $A. } asRest)))) == false) not)                                           	ifTrue: [ [                                             ((SmallScheme globalRef:  #'display')                                                  value: (((SmallScheme globalRef:  #'car')                                                  value: ( arglist))) value: ( port)).                                             (anycharX2Ddispatch value: (((SmallScheme globalRef:  #'X2B')                                                  value: ( pos) value: ( 1))) value: (((SmallScheme globalRef:  #'cdr')                                                  value: ( arglist))) value: ( false)).                                            ] value]                                           	ifFalse: [ [ :key58 |                                                 (((((SmallScheme globalRef:  #'memv')                                                        value: ( key58) value: ( ({ $S. } asRest)))) == false) not)                                                   	ifTrue: [ [                                                     ((SmallScheme globalRef:  #'write')                                                          value: (((SmallScheme globalRef:  #'car')                                                          value: ( arglist))) value: ( port)).                                                     (anycharX2Ddispatch value: (((SmallScheme globalRef:  #'X2B')                                                          value: ( pos) value: ( 1))) value: (((SmallScheme globalRef:  #'cdr')                                                          value: ( arglist))) value: ( false)).                                                    ] value]                                                   	ifFalse: [ [ :key59 |                                                         (((((SmallScheme globalRef:  #'memv')                                                                value: ( key59) value: ( ({ $D. } asRest)))) == false) not)                                                           	ifTrue: [ [                                                             ((SmallScheme globalRef:  #'display')                                                                  value: (((SmallScheme globalRef:  #'numberX2DX3Estring')                                                                  value: (((SmallScheme globalRef:  #'car')                                                                  value: ( arglist))) value: ( 10))) value: ( port)).                                                             (anycharX2Ddispatch value: (((SmallScheme globalRef:  #'X2B')                                                                  value: ( pos) value: ( 1))) value: (((SmallScheme globalRef:  #'cdr')                                                                  value: ( arglist))) value: ( false)).                                                            ] value]                                                           	ifFalse: [ [ :key60 |                                                                 (((((SmallScheme globalRef:  #'memv')                                                                        value: ( key60) value: ( ({ $X. } asRest)))) == false) not)                                                                   	ifTrue: [ [                                                                     ((SmallScheme globalRef:  #'display')                                                                          value: (((SmallScheme globalRef:  #'numberX2DX3Estring')                                                                          value: (((SmallScheme globalRef:  #'car')                                                                          value: ( arglist))) value: ( 16))) value: ( port)).                                                                     (anycharX2Ddispatch value: (((SmallScheme globalRef:  #'X2B')                                                                          value: ( pos) value: ( 1))) value: (((SmallScheme globalRef:  #'cdr')                                                                          value: ( arglist))) value: ( false)).                                                                    ] value]                                                                   	ifFalse: [ [ :key61 |                                                                         (((((SmallScheme globalRef:  #'memv')                                                                                value: ( key61) value: ( ({ $O. } asRest)))) == false) not)                                                                           	ifTrue: [ [                                                                             ((SmallScheme globalRef:  #'display')                                                                                  value: (((SmallScheme globalRef:  #'numberX2DX3Estring')                                                                                  value: (((SmallScheme globalRef:  #'car')                                                                                  value: ( arglist))) value: ( 8))) value: ( port)).                                                                             (anycharX2Ddispatch value: (((SmallScheme globalRef:  #'X2B')                                                                                  value: ( pos) value: ( 1))) value: (((SmallScheme globalRef:  #'cdr')                                                                                  value: ( arglist))) value: ( false)).                                                                            ] value]                                                                           	ifFalse: [ [ :key62 |                                                                                 (((((SmallScheme globalRef:  #'memv')                                                                                        value: ( key62) value: ( ({ $B. } asRest)))) == false) not)                                                                                   	ifTrue: [ [                                                                                     ((SmallScheme globalRef:  #'display')                                                                                          value: (((SmallScheme globalRef:  #'numberX2DX3Estring')                                                                                          value: (((SmallScheme globalRef:  #'car')                                                                                          value: ( arglist))) value: ( 2))) value: ( port)).                                                                                     (anycharX2Ddispatch value: (((SmallScheme globalRef:  #'X2B')                                                                                          value: ( pos) value: ( 1))) value: (((SmallScheme globalRef:  #'cdr')                                                                                          value: ( arglist))) value: ( false)).                                                                                    ] value]                                                                                   	ifFalse: [ [ :key63 |                                                                                         (((((SmallScheme globalRef:  #'memv')                                                                                                value: ( key63) value: ( ({ $C. } asRest)))) == false) not)                                                                                           	ifTrue: [ [                                                                                             ((SmallScheme globalRef:  #'writeX2Dchar')                                                                                                  value: (((SmallScheme globalRef:  #'car')                                                                                                  value: ( arglist))) value: ( port)).                                                                                             (anycharX2Ddispatch value: (((SmallScheme globalRef:  #'X2B')                                                                                                  value: ( pos) value: ( 1))) value: (((SmallScheme globalRef:  #'cdr')                                                                                                  value: ( arglist))) value: ( false)).                                                                                            ] value]                                                                                           	ifFalse: [ [ :key64 |                                                                                                 (((((SmallScheme globalRef:  #'memv')                                                                                                        value: ( key64) value: ( ({ $P. } asRest)))) == false) not)                                                                                                   	ifTrue: [ [                                                                                                      (((((SmallScheme globalRef:  #'X3D')                                                                                                              value: (((SmallScheme globalRef:  #'car')                                                                                                              value: ( arglist))) value: ( 1))) == false) not)                                                                                                         	ifTrue: [ false]                                                                                                         	ifFalse: [((SmallScheme globalRef:  #'writeX2Dchar')                                                                                                              value: ( $s) value: ( port))].                                                                                                     (anycharX2Ddispatch value: (((SmallScheme globalRef:  #'X2B')                                                                                                          value: ( pos) value: ( 1))) value: (((SmallScheme globalRef:  #'cdr')                                                                                                          value: ( arglist))) value: ( false)).                                                                                                    ] value]                                                                                                   	ifFalse: [ [ :key65 |                                                                                                         (((((SmallScheme globalRef:  #'memv')                                                                                                                value: ( key65) value: ( ({ $~. } asRest)))) == false) not)                                                                                                           	ifTrue: [ [                                                                                                             ((SmallScheme globalRef:  #'writeX2Dchar')                                                                                                                  value: ( $~) value: ( port)).                                                                                                             (anycharX2Ddispatch value: (((SmallScheme globalRef:  #'X2B')                                                                                                                  value: ( pos) value: ( 1))) value: ( arglist) value: ( false)).                                                                                                            ] value]                                                                                                           	ifFalse: [ [ :key66 |                                                                                                                 (((((SmallScheme globalRef:  #'memv')                                                                                                                        value: ( key66) value: ( ({ $%. } asRest)))) == false) not)                                                                                                                   	ifTrue: [ [                                                                                                                     ((SmallScheme globalRef:  #'newline')                                                                                                                          value: ( port)).                                                                                                                     (anycharX2Ddispatch value: (((SmallScheme globalRef:  #'X2B')                                                                                                                          value: ( pos) value: ( 1))) value: ( arglist) value: ( true)).                                                                                                                    ] value]                                                                                                                   	ifFalse: [ [ :key67 |                                                                                                                         (((((SmallScheme globalRef:  #'memv')                                                                                                                                value: ( key67) value: ( ({ $_. } asRest)))) == false) not)                                                                                                                           	ifTrue: [ [                                                                                                                             ((SmallScheme globalRef:  #'writeX2Dchar')                                                                                                                                  value: ( $ ) value: ( port)).                                                                                                                             (anycharX2Ddispatch value: (((SmallScheme globalRef:  #'X2B')                                                                                                                                  value: ( pos) value: ( 1))) value: ( arglist) value: ( false)).                                                                                                                            ] value]                                                                                                                           	ifFalse: [ [ :key68 |                                                                                                                                 (((((SmallScheme globalRef:  #'memv')                                                                                                                                        value: ( key68) value: ( ({ $&. } asRest)))) == false) not)                                                                                                                                   	ifTrue: [ [                                                                                                                                      (((((SmallScheme globalRef:  #'not')                                                                                                                                              value: ( lastX2DcharX2DwasX2Dnl))) == false) not)                                                                                                                                         	ifTrue: [((SmallScheme globalRef:  #'newline')                                                                                                                                              value: ( port))].                                                                                                                                     (anycharX2Ddispatch value: (((SmallScheme globalRef:  #'X2B')                                                                                                                                          value: ( pos) value: ( 1))) value: ( arglist) value: ( true)).                                                                                                                                    ] value]                                                                                                                                   	ifFalse: [ [ :key69 |                                                                                                                                         (((((SmallScheme globalRef:  #'memv')                                                                                                                                                value: ( key69) value: ( ({ $T. } asRest)))) == false) not)                                                                                                                                           	ifTrue: [ [                                                                                                                                             ((SmallScheme globalRef:  #'writeX2Dchar')                                                                                                                                                  value: ( asciiX2Dtab) value: ( port)).                                                                                                                                             (anycharX2Ddispatch value: (((SmallScheme globalRef:  #'X2B')                                                                                                                                                  value: ( pos) value: ( 1))) value: ( arglist) value: ( false)).                                                                                                                                            ] value]                                                                                                                                           	ifFalse: [ [ :key70 |                                                                                                                                                 (((((SmallScheme globalRef:  #'memv')                                                                                                                                                        value: ( key70) value: ( ({ $|. } asRest)))) == false) not)                                                                                                                                                   	ifTrue: [ [                                                                                                                                                     ((SmallScheme globalRef:  #'writeX2Dchar')                                                                                                                                                          value: ( asciiX2Dff) value: ( port)).                                                                                                                                                     (anycharX2Ddispatch value: (((SmallScheme globalRef:  #'X2B')                                                                                                                                                          value: ( pos) value: ( 1))) value: ( arglist) value: ( true)).                                                                                                                                                    ] value]                                                                                                                                                   	ifFalse: [ [ :key71 |                                                                                                                                                         (((((SmallScheme globalRef:  #'memv')                                                                                                                                                                value: ( key71) value: ( ({ $G. } asRest)))) == false) not)                                                                                                                                                           	ifTrue: [ [                                                                                                                                                              (((((SmallScheme globalRef:  #'eqX3F')                                                                                                                                                                      value: ( port) value: ( false))) == false) not)                                                                                                                                                                 	ifTrue: [((SmallScheme globalRef:  #'display')                                                                                                                                                                      value: (((SmallScheme globalRef:  #'prettyX2DprintX2DtoX2Dstring')                                                                                                                                                                      value: (((SmallScheme globalRef:  #'car')                                                                                                                                                                      value: ( arglist))))) value: ( port))]                                                                                                                                                                 	ifFalse: [((SmallScheme globalRef:  #'prettyX2Dprint')                                                                                                                                                                      value: (((SmallScheme globalRef:  #'car')                                                                                                                                                                      value: ( arglist))) value: ( port))].                                                                                                                                                             (anycharX2Ddispatch value: (((SmallScheme globalRef:  #'X2B')                                                                                                                                                                  value: ( pos) value: ( 1))) value: (((SmallScheme globalRef:  #'cdr')                                                                                                                                                                  value: ( arglist))) value: ( true)).                                                                                                                                                            ] value]                                                                                                                                                           	ifFalse: [ [ :key72 |                                                                                                                                                                 (((((SmallScheme globalRef:  #'memv')                                                                                                                                                                        value: ( key72) value: ( ({ $?. } asRest)))) == false) not)                                                                                                                                                                   	ifTrue: [ [                                                                                                                                                                     (lastX2DwasX2Dnewline :=  lastX2DcharX2DwasX2Dnl).                                                                                                                                                                     (anycharX2Ddispatch value: (((SmallScheme globalRef:  #'X2B')                                                                                                                                                                          value: ( pos) value: ( 1))) value: ((formatX2Dhelp value: (((SmallScheme globalRef:  #'car')                                                                                                                                                                          value: ( arglist))) value: (((SmallScheme globalRef:  #'cdr')                                                                                                                                                                          value: ( arglist))))) value: ( lastX2DwasX2Dnewline)).                                                                                                                                                                    ] value]                                                                                                                                                                   	ifFalse: [ [                                                                                                                                                                      key72.                                                                                                                                                                     ((SmallScheme globalRef:  #'error')                                                                                                                                                                          value: ( 'FORMAT: unknown tilde escape') value: (((SmallScheme globalRef:  #'stringX2Dref')                                                                                                                                                                          value: ( formatX2Dstrg) value: ( pos)))).                                                                                                                                                                    ] value].                                                                                                                                                           ] valueWithArguments: {( key71). }].                                                                                                                                                   ] valueWithArguments: {( key70). }].                                                                                                                                           ] valueWithArguments: {( key69). }].                                                                                                                                   ] valueWithArguments: {( key68). }].                                                                                                                           ] valueWithArguments: {( key67). }].                                                                                                                   ] valueWithArguments: {( key66). }].                                                                                                           ] valueWithArguments: {( key65). }].                                                                                                   ] valueWithArguments: {( key64). }].                                                                                           ] valueWithArguments: {( key63). }].                                                                                   ] valueWithArguments: {( key62). }].                                                                           ] valueWithArguments: {( key61). }].                                                                   ] valueWithArguments: {( key60). }].                                                           ] valueWithArguments: {( key59). }].                                                   ] valueWithArguments: {( key58). }].                                           ] valueWithArguments: {( key57). }].                                   ] valueWithArguments: {(((SmallScheme globalRef:  #'charX2Dupcase')                                            value: (((SmallScheme globalRef:  #'stringX2Dref')                                            value: ( formatX2Dstrg) value: ( pos))))). }]]).                             (anycharX2Ddispatch value: ( 00) value: ( arglyst) value: ( lastX2DwasX2Dnewline)).                         ] value]).                        [                         (formatX2Dhelp value: ( X3CformatX2DstringX3E) value: ( X3CargsX3E)).                         (returnX2Dvalue value).                        ] value.                   ] value.               ] value] withLastArgRest .       ] valueWithArguments: {( false). (((SmallScheme globalRef:  #'integerX2DX3Echar')                value: ( 9))). (((SmallScheme globalRef:  #'integerX2DX3Echar')                value: ( 12))). (((SmallScheme globalRef:  #'stringX2DX3Esymbol')                value: ( ''))). } ) .! !