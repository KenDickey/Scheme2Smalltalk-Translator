'# This file is encoded in ASCII# line delimitor is CR.SmallSchemeSmallScheme code for Squeak 3.0Translated from file /usr/local/src/Squeak/ProtoScheme/scm/test6.scm'!!SmallScheme methodsFor: 'user'!test6    "Capture self as env for use by nested block code"    | schemeEnv | schemeEnv := self.  schemeEnv define:  #'curX2Dsection'    "cur-section"  as: (  nil ) . schemeEnv define:  #'errs'  as: (  nil ) . schemeEnv define:  #'section'  as: (        [ :args |            args := args asRest.            [             ((schemeEnv globalRef:  #'display')                  value: ( 'SECTION')).             ((schemeEnv globalRef:  #'write')                  value: ( args)).             ((schemeEnv globalRef:  #'newline')                  value).             (schemeEnv setX21:  #'curX2Dsection' as:  args).              true.            ] value] withLastArgRest  ) . schemeEnv define:  #'recordX2Derror'    "record-error"  as: (        [ :e | (schemeEnv setX21:  #'errs' as: ((schemeEnv globalRef:  #'cons')                value: (((schemeEnv globalRef:  #'list')                value: ( (schemeEnv globalRef:  #'curX2Dsection')               ) value: ( e))) value: ( (schemeEnv globalRef:  #'errs')               )))] ) . schemeEnv define:  #'test'  as: (        [ :expect :fun :args |            args := args asRest.            [             ((schemeEnv globalRef:  #'write')                  value: (((schemeEnv globalRef:  #'cons')                  value: ( fun) value: ( args)))).             ((schemeEnv globalRef:  #'display')                  value: ( '  ==> ')).             ((             [ :res |  [                   ((schemeEnv globalRef:  #'write')                        value: ( res)).                   ((schemeEnv globalRef:  #'newline')                        value).                    (((((schemeEnv globalRef:  #'not')                            value: (((schemeEnv globalRef:  #'equalX3F')                            value: ( expect) value: ( res))))) == false) not)                       	ifTrue: [ [                         ((schemeEnv globalRef:  #'recordX2Derror')                              value: (((schemeEnv globalRef:  #'list')                              value: ( res) value: ( expect) value: (((schemeEnv globalRef:  #'cons')                              value: ( fun) value: ( args)))))).                         ((schemeEnv globalRef:  #'display')                              value: ( ' BUT EXPECTED ')).                         ((schemeEnv globalRef:  #'write')                              value: ( expect)).                         ((schemeEnv globalRef:  #'newline')                              value).                          false.                        ] value]                       	ifFalse: [ true].                  ] value]) value: ( (((((schemeEnv globalRef:  #'procedureX3F')                      value: ( fun))) == false) not)                 	ifTrue: [((schemeEnv globalRef:  #'apply')                      value: ( fun) value: ( args))]                 	ifFalse: [((schemeEnv globalRef:  #'car')                      value: ( args))])).            ] value] withLastArgRest  ) . schemeEnv define:  #'reportX2Derrs'    "report-errs"  as: (        [ [             ((schemeEnv globalRef:  #'newline')                  value).              (((((schemeEnv globalRef:  #'nullX3F')                      value: ( (schemeEnv globalRef:  #'errs')                     ))) == false) not)                 	ifTrue: [((schemeEnv globalRef:  #'display')                      value: ( 'Passed all tests'))]                 	ifFalse: [ [                   ((schemeEnv globalRef:  #'display')                        value: ( 'errors were:')).                   ((schemeEnv globalRef:  #'newline')                        value).                   ((schemeEnv globalRef:  #'display')                        value: ( '(SECTION (got expected (call)))')).                   ((schemeEnv globalRef:  #'newline')                        value).                   ((schemeEnv globalRef:  #'forX2Deach')                        value: (                   [ :l |  [                         ((schemeEnv globalRef:  #'write')                              value: ( l)).                         ((schemeEnv globalRef:  #'newline')                              value).                        ] value]) value: ( (schemeEnv globalRef:  #'errs')                       )).                  ] value].             ((schemeEnv globalRef:  #'newline')                  value).            ] value] ) .((schemeEnv globalRef:  #'section')      value: ( 6) value: ( 5) value: ( 6)).((schemeEnv globalRef:  #'test')      value: ( '0') value: ( (schemeEnv globalRef:  #'numberX2DX3Estring')     ) value: ( 00)).((schemeEnv globalRef:  #'test')      value: ( '100') value: ( (schemeEnv globalRef:  #'numberX2DX3Estring')     ) value: ( 100)).((schemeEnv globalRef:  #'test')       valueWithArguments: {  '100'.  (schemeEnv globalRef:  #'numberX2DX3Estring')     .  256.  16.}).((schemeEnv globalRef:  #'test')      value: ( 100) value: ( (schemeEnv globalRef:  #'stringX2DX3Enumber')     ) value: ( '100')).((schemeEnv globalRef:  #'test')       valueWithArguments: {  256.  (schemeEnv globalRef:  #'stringX2DX3Enumber')     .  '100'.  16.}).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'stringX2DX3Enumber')     ) value: ( '')).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'stringX2DX3Enumber')     ) value: ( '.')).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'stringX2DX3Enumber')     ) value: ( 'd')).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'stringX2DX3Enumber')     ) value: ( 'D')).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'stringX2DX3Enumber')     ) value: ( 'i')).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'stringX2DX3Enumber')     ) value: ( 'I')).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'stringX2DX3Enumber')     ) value: ( '3i')).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'stringX2DX3Enumber')     ) value: ( '3I')).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'stringX2DX3Enumber')     ) value: ( '33i')).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'stringX2DX3Enumber')     ) value: ( '33I')).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'stringX2DX3Enumber')     ) value: ( '3.3i')).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'stringX2DX3Enumber')     ) value: ( '3.3I')).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'stringX2DX3Enumber')     ) value: ( '-')).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'stringX2DX3Enumber')     ) value: ( '+')).((schemeEnv globalRef:  #'section')      value: ( 6) value: ( 6)).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'eqvX3F')     .  $ .  $ .}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'eqvX3F')     .  $ .  $ .}).((schemeEnv globalRef:  #'test')      value: ( true) value: ( (schemeEnv globalRef:  #'charX3F')     ) value: ( $a)).((schemeEnv globalRef:  #'test')      value: ( true) value: ( (schemeEnv globalRef:  #'charX3F')     ) value: ( $()).((schemeEnv globalRef:  #'test')      value: ( true) value: ( (schemeEnv globalRef:  #'charX3F')     ) value: ( $ )).((schemeEnv globalRef:  #'test')      value: ( true) value: ( (schemeEnv globalRef:  #'charX3F')     ) value: ((Character cr))).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX3DX3F')     .  $A.  $B.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX3DX3F')     .  $a.  $b.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX3DX3F')     .  $9.  $0.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX3DX3F')     .  $A.  $A.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX3CX3F')     .  $A.  $B.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX3CX3F')     .  $a.  $b.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX3CX3F')     .  $9.  $0.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX3CX3F')     .  $A.  $A.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX3EX3F')     .  $A.  $B.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX3EX3F')     .  $a.  $b.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX3EX3F')     .  $9.  $0.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX3EX3F')     .  $A.  $A.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX3CX3DX3F')     .  $A.  $B.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX3CX3DX3F')     .  $a.  $b.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX3CX3DX3F')     .  $9.  $0.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX3CX3DX3F')     .  $A.  $A.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX3EX3DX3F')     .  $A.  $B.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX3EX3DX3F')     .  $a.  $b.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX3EX3DX3F')     .  $9.  $0.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX3EX3DX3F')     .  $A.  $A.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX2DciX3DX3F')     .  $A.  $B.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX2DciX3DX3F')     .  $a.  $B.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX2DciX3DX3F')     .  $A.  $b.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX2DciX3DX3F')     .  $a.  $b.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX2DciX3DX3F')     .  $9.  $0.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX2DciX3DX3F')     .  $A.  $A.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX2DciX3DX3F')     .  $A.  $a.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX2DciX3CX3F')     .  $A.  $B.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX2DciX3CX3F')     .  $a.  $B.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX2DciX3CX3F')     .  $A.  $b.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX2DciX3CX3F')     .  $a.  $b.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX2DciX3CX3F')     .  $9.  $0.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX2DciX3CX3F')     .  $A.  $A.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX2DciX3CX3F')     .  $A.  $a.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX2DciX3EX3F')     .  $A.  $B.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX2DciX3EX3F')     .  $a.  $B.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX2DciX3EX3F')     .  $A.  $b.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX2DciX3EX3F')     .  $a.  $b.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX2DciX3EX3F')     .  $9.  $0.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX2DciX3EX3F')     .  $A.  $A.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX2DciX3EX3F')     .  $A.  $a.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX2DciX3CX3DX3F')     .  $A.  $B.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX2DciX3CX3DX3F')     .  $a.  $B.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX2DciX3CX3DX3F')     .  $A.  $b.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX2DciX3CX3DX3F')     .  $a.  $b.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX2DciX3CX3DX3F')     .  $9.  $0.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX2DciX3CX3DX3F')     .  $A.  $A.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX2DciX3CX3DX3F')     .  $A.  $a.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX2DciX3EX3DX3F')     .  $A.  $B.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX2DciX3EX3DX3F')     .  $a.  $B.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX2DciX3EX3DX3F')     .  $A.  $b.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  false.  (schemeEnv globalRef:  #'charX2DciX3EX3DX3F')     .  $a.  $b.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX2DciX3EX3DX3F')     .  $9.  $0.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX2DciX3EX3DX3F')     .  $A.  $A.}).((schemeEnv globalRef:  #'test')       valueWithArguments: {  true.  (schemeEnv globalRef:  #'charX2DciX3EX3DX3F')     .  $A.  $a.}).((schemeEnv globalRef:  #'test')      value: ( true) value: ( (schemeEnv globalRef:  #'charX2DalphabeticX3F')     ) value: ( $a)).((schemeEnv globalRef:  #'test')      value: ( true) value: ( (schemeEnv globalRef:  #'charX2DalphabeticX3F')     ) value: ( $A)).((schemeEnv globalRef:  #'test')      value: ( true) value: ( (schemeEnv globalRef:  #'charX2DalphabeticX3F')     ) value: ( $z)).((schemeEnv globalRef:  #'test')      value: ( true) value: ( (schemeEnv globalRef:  #'charX2DalphabeticX3F')     ) value: ( $Z)).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DalphabeticX3F')     ) value: ( $0)).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DalphabeticX3F')     ) value: ( $9)).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DalphabeticX3F')     ) value: ( $ )).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DalphabeticX3F')     ) value: ( $;)).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DnumericX3F')     ) value: ( $a)).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DnumericX3F')     ) value: ( $A)).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DnumericX3F')     ) value: ( $z)).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DnumericX3F')     ) value: ( $Z)).((schemeEnv globalRef:  #'test')      value: ( true) value: ( (schemeEnv globalRef:  #'charX2DnumericX3F')     ) value: ( $0)).((schemeEnv globalRef:  #'test')      value: ( true) value: ( (schemeEnv globalRef:  #'charX2DnumericX3F')     ) value: ( $9)).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DnumericX3F')     ) value: ( $ )).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DnumericX3F')     ) value: ( $;)).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DwhitespaceX3F')     ) value: ( $a)).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DwhitespaceX3F')     ) value: ( $A)).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DwhitespaceX3F')     ) value: ( $z)).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DwhitespaceX3F')     ) value: ( $Z)).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DwhitespaceX3F')     ) value: ( $0)).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DwhitespaceX3F')     ) value: ( $9)).((schemeEnv globalRef:  #'test')      value: ( true) value: ( (schemeEnv globalRef:  #'charX2DwhitespaceX3F')     ) value: ( $ )).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DwhitespaceX3F')     ) value: ( $;)).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DupperX2DcaseX3F')     ) value: ( $0)).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DupperX2DcaseX3F')     ) value: ( $9)).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DupperX2DcaseX3F')     ) value: ( $ )).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DupperX2DcaseX3F')     ) value: ( $;)).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DlowerX2DcaseX3F')     ) value: ( $0)).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DlowerX2DcaseX3F')     ) value: ( $9)).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DlowerX2DcaseX3F')     ) value: ( $ )).((schemeEnv globalRef:  #'test')      value: ( false) value: ( (schemeEnv globalRef:  #'charX2DlowerX2DcaseX3F')     ) value: ( $;)).((schemeEnv globalRef:  #'test')      value: ( $.) value: ( (schemeEnv globalRef:  #'integerX2DX3Echar')     ) value: (((schemeEnv globalRef:  #'charX2DX3Einteger')      value: ( $.)))).((schemeEnv globalRef:  #'test')      value: ( $A) value: ( (schemeEnv globalRef:  #'integerX2DX3Echar')     ) value: (((schemeEnv globalRef:  #'charX2DX3Einteger')      value: ( $A)))).((schemeEnv globalRef:  #'test')      value: ( $a) value: ( (schemeEnv globalRef:  #'integerX2DX3Echar')     ) value: (((schemeEnv globalRef:  #'charX2DX3Einteger')      value: ( $a)))).((schemeEnv globalRef:  #'test')      value: ( $A) value: ( (schemeEnv globalRef:  #'charX2Dupcase')     ) value: ( $A)).((schemeEnv globalRef:  #'test')      value: ( $A) value: ( (schemeEnv globalRef:  #'charX2Dupcase')     ) value: ( $a)).((schemeEnv globalRef:  #'test')      value: ( $a) value: ( (schemeEnv globalRef:  #'charX2Ddowncase')     ) value: ( $A)).((schemeEnv globalRef:  #'test')      value: ( $a) value: ( (schemeEnv globalRef:  #'charX2Ddowncase')     ) value: ( $a)).((schemeEnv globalRef:  #'reportX2Derrs')      value).((schemeEnv globalRef:  #'newline')      value). 'last item in file'.! !